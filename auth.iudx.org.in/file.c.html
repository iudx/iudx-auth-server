<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/iudx-auth-server/auth.iudx.org.in/file.c.html</title>
<meta name="Generator" content="Vim/8.1">
<meta name="plugin-version" content="vim8.1_v1">
<meta name="syntax" content="c">
<meta name="settings" content="use_css,pre_wrap,no_foldcolumn,prevent_copy=">
<meta name="colorscheme" content="delek">
<style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #ffffff; background-color: #000000; }
body { font-family: monospace; color: #ffffff; background-color: #000000; }
* { font-size: 1em; }
.rainbow_o0 { color: #8080ff; font-weight: bold; }
.Comment { color: #ff6060; }
.rainbow_o1 { color: #ffff00; font-weight: bold; }
.rainbow_p1 { color: #ffff00; font-weight: bold; }
.rainbow_p0 { color: #8080ff; font-weight: bold; }
.Constant { color: #00ff00; }
.Type { color: #8080ff; font-weight: bold; }
.rainbow_p2 { color: #00ffff; font-weight: bold; }
.Statement { color: #8080ff; font-weight: bold; }
-->
</style>
</head>
<body>
<pre id='vimCodeElement'>

*Request <span class="Statement">for</span> an access token*
*---------------------------*

<span class="Statement">Endpoint</span>:

	$HTTPS$&lt;auth-server&gt;/auth/v1/token

<span class="Statement">Description</span>:

	This API is used to request an access token from the Auth server.
	The <span class="Constant">&quot;token&quot;</span> can then be used to get data from a resource server.

<span class="Statement">Called_xxx_by</span>:

	A data consumer with a valid class-<span class="Constant">2</span> or above certificate.

<span class="Statement">Methods</span>:

	POST

<span class="Statement">Headers</span>:

	content-type : <span class="Constant">&quot;application/json&quot;</span>

	Please note that <span class="Constant">&quot;text/plain&quot;</span> can also be used to avoid CORS issues.

<span class="Statement">Body_xxx_in_xxx_JSON_xxx_format</span>:

	<span class="rainbow_p0">{</span>
		<span class="Constant">&quot;request&quot;</span> : <span class="rainbow_p1">{</span>											<span class="Comment">// required</span>
			<span class="Constant">&quot;id&quot;</span>		: &lt;a resource id <span class="Statement">for</span> which access is requested&gt;<span class="rainbow_o1">,</span>			<span class="Comment">// required</span>
			<span class="Constant">&quot;apis&quot;</span>		: &lt;a list of APIs a consumer wishes to access on the resource id&gt;	<span class="Comment">// optional</span>
			<span class="Constant">&quot;methods&quot;</span>	: &lt;a list of methods a consumer wishes to call on the APIs&gt;		<span class="Comment">// optional</span>
			<span class="Constant">&quot;body&quot;</span>		: &lt;a dictionary of body variables to be called with the API&gt;		<span class="Comment">// optional</span>
		<span class="rainbow_p1">}</span><span class="rainbow_o0">,</span>

		<span class="Constant">&quot;token-time&quot;</span>		: &lt;the time in seconds<span class="rainbow_o0">,</span> till which the token should be valid&gt;		<span class="Comment">// optional</span>
		<span class="Constant">&quot;existing-token&quot;</span>	: &lt;a valid token a data consumer already has&gt;				<span class="Comment">// optional</span>
	<span class="rainbow_p0">}</span>

	The 'request' field may also be an array of objects.

	The <span class="Constant">&quot;existing-token&quot;</span> header field is used to indicate that new token
	should NOT be created; i.e. the existing token will be used to access
	the new requested list of resource ids.

	The_xxx_'request'_xxx_fields_xxx_are:

	<span class="Constant">1.</span>_xxx_id:

		The <span class="Constant">&quot;id&quot;</span> is the identifer of the resource <span class="rainbow_p0">(</span>a data-set<span class="rainbow_p0">)</span> the consumer is interested in accessing.

		Data consumers are not expected to create these <span class="Constant">&quot;ids&quot;</span> themselves;
		but are expected to get these <span class="Constant">&quot;id&quot;</span>s from a catalogue server.

		An example catalog server is: $HTTPS$varanasi.iudx.org.in

		<span class="Statement">And_xxx_an_xxx_example_xxx_query_xxx_to_xxx_get_xxx_ids_xxx_is</span>:
			$HTTPS$varanasi.iudx.org.in/catalogue/v1/search?item-type=resourceItem

		The_xxx_resource_xxx_'id'_xxx_consists_xxx_of_xxx_at_xxx_least_xxx_4_xxx_parts_xxx_seperated_xxx_by_xxx_a_xxx_<span class="Constant">'/'</span>_xxx_indicating:

			<span class="Constant">1.</span> The email domain of the data provider.

			<span class="Constant">2.</span> SHA-<span class="Constant">1</span> hash of the data provider's email-id <span class="rainbow_p0">(</span>to mask the provider's email<span class="rainbow_p0">)</span>.

			<span class="Constant">3.</span> The hostname <span class="rainbow_p0">(</span>FQDN<span class="rainbow_p0">)</span> of the resource server where the resource is hosted.

			<span class="Constant">4.</span> The name of the resource <span class="rainbow_p0">(</span>which may contain additional <span class="Constant">'/'</span>s<span class="rainbow_p0">)</span>.

		For example: example.com/9cf2c2382cf661fc20a4776345a3be7a143a109c/rs.com/resource-name

	<span class="Constant">2.</span>_xxx_apis:

		The 'apis' is the set of APIs a consumer wants to access on a 'id'.
		Instead of 'apis', just 'api' <span class="rainbow_p0">(</span>a string<span class="rainbow_p0">)</span> could also be used.

		For example: <span class="rainbow_p0">[</span><span class="Constant">&quot;/latest&quot;</span><span class="rainbow_o0">,</span> <span class="Constant">&quot;/query&quot;</span><span class="rainbow_p0">]</span>
		As the field is optional, the <span class="Statement">default</span> value of 'apis' is: <span class="rainbow_p0">[</span><span class="Constant">&quot;/*&quot;</span><span class="rainbow_p0">]</span>

	<span class="Constant">3.</span>_xxx_methods:

		The 'methods' is the set of methods a consumer wants to access on an 'api'.
		Instead of 'methods', just 'method' <span class="rainbow_p0">(</span>a string<span class="rainbow_p0">)</span> could also be used.

		For example: <span class="rainbow_p0">[</span><span class="Constant">&quot;GET&quot;</span><span class="rainbow_o0">,</span> <span class="Constant">&quot;POST&quot;</span><span class="rainbow_p0">]</span>
		As the field is optional, the <span class="Statement">default</span> value of 'apis' is: <span class="rainbow_p0">[</span><span class="Constant">&quot;*&quot;</span><span class="rainbow_p0">]</span>

	<span class="Constant">4.</span>_xxx_body:

		The body indicates the JSON body to be passed with the 'apis'.

		For example: <span class="rainbow_p0">{</span><span class="Constant">&quot;operation&quot;</span> : <span class="Constant">&quot;select&quot;</span><span class="rainbow_o0">,</span> <span class="Constant">&quot;on&quot;</span> : <span class="Constant">&quot;all&quot;</span><span class="rainbow_p0">}</span>
		As the field is optional, the <span class="Statement">default</span> value of 'body' is: null


<span class="Statement">HTTP_xxx_response_xxx_code</span>:

	<span class="Constant">200</span>
		If access is allowed.

	<span class="Constant">403</span>
		If access is denied.

	<span class="Constant">429</span>
		If the client makes too many requests.

<span class="Statement">Using_xxx_pyIUDX_xxx_SDK</span>:

	from pyIUDX.auth import auth

	iudx_auth = auth.Auth<span class="rainbow_p0">(</span><span class="Constant">&quot;certificate.pem&quot;</span><span class="rainbow_o0">,</span><span class="Constant">&quot;private-key.pem&quot;</span><span class="rainbow_p0">)</span>

	request = <span class="rainbow_p0">[</span>
		<span class="rainbow_p1">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/9cf2c2382cf661fc20a4776345a3be7a143a109c/rs.com/r1&quot;</span><span class="rainbow_p1">}</span><span class="rainbow_o0">,</span>
		<span class="rainbow_p1">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/5332dabcd033fffca0a3332abcdefe7a143a109c/rs.com/r2&quot;</span><span class="rainbow_p1">}</span>
	<span class="rainbow_p0">]</span>

	iudx_auth.get_token<span class="rainbow_p0">(</span>request<span class="rainbow_p0">)</span>

<span class="Statement">CURL_xxx_examples</span>:

	<span class="Constant">1.</span> Requesting token <span class="Statement">for</span> data from a single resource server

		<span class="Statement">Request</span>:

			curl -XPOST $HTTPS$auth.iudx.org.in/auth/v1/token

			--cert certificate.pem --key private-key.pem

			-H 'content-type: application/json'

			-d '<span class="rainbow_p0">{</span>
				<span class="Constant">&quot;request&quot;</span> : <span class="rainbow_p1">[</span>
					<span class="rainbow_p2">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/9cf2c2382cf661fc20a4776345a3be7a143a109c/rs.com/r1&quot;</span><span class="rainbow_p2">}</span><span class="rainbow_o1">,</span>
					<span class="rainbow_p2">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/5332dabcd033fffca0a3332abcdefe7a143a109c/rs.com/r2&quot;</span><span class="rainbow_p2">}</span>
				<span class="rainbow_p1">]</span>
			<span class="rainbow_p0">}</span>'

		<span class="Statement">Response</span>:

			<span class="Constant">200</span> OK
			content-type : <span class="Constant">&quot;application/json&quot;</span>

			<span class="rainbow_p0">{</span>
				<span class="Constant">&quot;token&quot;</span>	: <span class="Constant">&quot;auth.iudx.org.in/user@domain.com/2204adcbc990ffff234689aaabcdef90&quot;</span><span class="rainbow_o0">,</span>
				<span class="Constant">&quot;token-type&quot;</span>	: <span class="Constant">&quot;IUDX&quot;</span><span class="rainbow_o0">,</span>
				<span class="Constant">&quot;expires-in&quot;</span>	: <span class="Constant">3600</span>
			<span class="rainbow_p0">}</span>

		<span class="Statement">Response_xxx_fields</span>:

		<span class="Constant">1.</span> token
			Is the access token required to access data from a resource server
			<span class="rainbow_p0">(</span>rs.com in this <span class="Statement">case</span><span class="rainbow_p0">)</span>, and is in the format: 'auth-server/consumer/random-bytes'

			A_xxx_valid_xxx_IUDX_xxx_token_xxx_consist_xxx_of_xxx_3_xxx_fields_xxx_<span class="rainbow_p0">(</span>delimited_xxx_by_xxx_<span class="Constant">'/'</span><span class="rainbow_p0">)</span>:

				<span class="Constant">1.</span> Who has issued the token <span class="rainbow_p0">(</span>The Auth server<span class="rainbow_p0">)</span>
				<span class="Constant">2.</span> To whom the token has been issued <span class="rainbow_p0">(</span>The consumer<span class="rainbow_p0">)</span>
				<span class="Constant">3.</span> Random string

			<span class="Statement">In_xxx_the_xxx_above_xxx_example</span>:
				token = <span class="Constant">&quot;auth.iudx.org.in/user@domain.com/2204adcbc990ffff234689aaabcdef90&quot;</span>

		<span class="Constant">2.</span> expires-in
			Indicates how <span class="Type">long</span> the token is valid in seconds.

	<span class="Constant">2.</span> Requesting token <span class="Statement">for</span> data from multiple resource servers

		<span class="Statement">Request</span>:

			curl -XPOST $HTTPS$auth.iudx.org.in/auth/v1/token

				--cert certificate.pem --key private-key.pem

				-H 'content-type: application/json'

				-d '<span class="rainbow_p0">{</span>
					<span class="Constant">&quot;request&quot;</span> : <span class="rainbow_p1">[</span>
						<span class="rainbow_p2">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/9cf2c2382cf661fc20a4776345a3be7a143a109c/rs1.com/r1&quot;</span><span class="rainbow_p2">}</span>
						<span class="rainbow_p2">{</span><span class="Constant">&quot;id&quot;</span>: <span class="Constant">&quot;example.com/9cf2c2382cf661fc20a4776345a3be7a143a109c/rs2.com/r2&quot;</span><span class="rainbow_p2">}</span>
					<span class="rainbow_p1">]</span>
				<span class="rainbow_p0">}</span>'
		<span class="Statement">Response</span>:

			<span class="Constant">200</span> OK
			content-type : <span class="Constant">&quot;application/json&quot;</span>

			<span class="rainbow_p0">{</span>
				<span class="Constant">&quot;token&quot;</span>	: <span class="Constant">&quot;auth.iudx.org.in/user@domain.com/1802a84d157ff4d113150aeca8bdacee&quot;</span><span class="rainbow_o0">,</span>
				<span class="Constant">&quot;token-type&quot;</span>	: <span class="Constant">&quot;IUDX&quot;</span><span class="rainbow_o0">,</span>
				<span class="Constant">&quot;expires-in&quot;</span>	: <span class="Constant">3600</span><span class="rainbow_o0">,</span>
				<span class="Constant">&quot;server-token&quot;</span>	: <span class="rainbow_p1">{</span>
					<span class="Constant">&quot;rs1.com&quot;</span> : <span class="Constant">&quot;rs1.com/91834abcd323924339ab&quot;</span><span class="rainbow_o1">,</span>
					<span class="Constant">&quot;rs2.com&quot;</span> : <span class="Constant">&quot;rs2.com/52338cdfff3222699900&quot;</span>
				<span class="rainbow_p1">}</span>
			<span class="rainbow_p0">}</span>

		<span class="Statement">Other_xxx_response_xxx_fields</span>:

			<span class="Constant">3.</span> server-token

				The <span class="Constant">&quot;server-token&quot;</span> field is sent only <span class="Statement">if</span> the request body
				contains id's from multiple resource servers

				<span class="Statement">In_xxx_this_xxx_example</span>:
					<span class="Constant">&quot;rs1.com&quot;</span> and <span class="Constant">&quot;rs2.com&quot;</span>

				In the above example, when requesting data from a resource server,
				the consumer must also provide the <span class="Constant">&quot;server-token&quot;</span> of the respective resource server,
				along with the consumer's <span class="Constant">&quot;token&quot;</span>.

				<span class="Statement">In_xxx_the_xxx_above_xxx_example</span>:
					token = <span class="Constant">&quot;auth.iudx.org.in/user@domain.com/1802a84d157ff4d113150aeca8bdacee&quot;</span>

				and_xxx_the_xxx_<span class="Constant">&quot;server-token&quot;</span>_xxx_when_xxx_a_xxx_consumer_xxx_requests_xxx_data_xxx_from:_xxx_

					<span class="Constant">&quot;rs1.com&quot;</span> is <span class="Constant">&quot;rs1.com/91834abcd323924339ab&quot;</span>,
							and
					<span class="Constant">&quot;rs2.com&quot;</span> is <span class="Constant">&quot;rs2.com/52338cdfff3222699900&quot;</span>

				The <span class="Constant">&quot;server-token&quot;</span> ensures that only a genuine resource server can access its token.

				<span class="Statement">NOTE</span>:

				The <span class="Constant">&quot;server-token&quot;</span>s may change <span class="Statement">if</span> <span class="Constant">&quot;existing-token&quot;</span> is used with
				multiple resource servers. Hence, consumers must update their
				<span class="Constant">&quot;server-token&quot;</span>s as in the API response.

<span class="Statement">See_xxx_also</span>:

	<span class="Statement">token_xxx_introspect_xxx_API</span>:
		$HTTP$auth.iudx.org.in/token-introspect.html

	<span class="Statement">token_xxx_revoke_xxx_API</span>:
		$HTTP$auth.iudx.org.in/token-revoke.html

	<span class="Statement">token_xxx_revoke_xxx_all_xxx_API</span>:
		$HTTP$auth.iudx.org.in/token-revoke-all.html


</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
